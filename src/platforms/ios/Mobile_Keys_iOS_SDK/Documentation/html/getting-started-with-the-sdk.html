<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Getting started with the SDK  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Getting started with the SDK  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          SeosMobileKeysSDK Docs
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">SeosMobileKeysSDK Reference</a>
      <img class="carat" src="img/carat.png" />
      Getting started with the SDK  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Getting started.html">Getting started</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="getting-started-with-the-sdk.html">Getting started with the SDK</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation-without-cocoapods.html">Installation without CocoaPods</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="logging.html">Logging</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Mobile Keys.html">Mobile Keys</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysManager.html">MobileKeysManager</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MobileKeysManagerDelegate.html">MobileKeysManagerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysEndpointInfo.html">MobileKeysEndpointInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysKey.html">MobileKeysKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysLastAuthenticationInfo.html">MobileKeysLastAuthenticationInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysErrorDomain">MobileKeysErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysHttpErrorDomain">MobileKeysHttpErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysOptionApplicationId">MobileKeysOptionApplicationId</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysOptionVersion">MobileKeysOptionVersion</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/EnvironmentType.html">EnvironmentType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysInfoType.html">MobileKeysInfoType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysErrorCode.html">MobileKeysErrorCode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysPreconditionFailedException">MobileKeysPreconditionFailedException</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@F@MobileKeysPreconditionCheckTriggered">MobileKeysPreconditionCheckTriggered</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Bluetooth.html">Bluetooth</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysOpeningResult.html">MobileKeysOpeningResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysTimeoutConfiguration.html">MobileKeysTimeoutConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysOpeningStatusType.html">MobileKeysOpeningStatusType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysOpeningType.html">MobileKeysOpeningType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysReader.html">MobileKeysReader</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysScanMode.html">MobileKeysScanMode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysReaderProtocolVersion.html">MobileKeysReaderProtocolVersion</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Seos Access API.html">Seos Access API</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSeosSession.html">MobileKeysSeosSession</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSeosTag.html">MobileKeysSeosTag</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysApduCommand.html">MobileKeysApduCommand</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MobileKeysApduConnectionProtocol.html">MobileKeysApduConnectionProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysApduResponse.html">MobileKeysApduResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysAuthenticationKeySet.html">MobileKeysAuthenticationKeySet</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysMasterAuthenticationKeySet.html">MobileKeysMasterAuthenticationKeySet</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysGetDataApduCommand.html">MobileKeysGetDataApduCommand</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysPrivacyKeySet.html">MobileKeysPrivacyKeySet</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysPutDataApduCommand.html">MobileKeysPutDataApduCommand</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSeosProvider.html">MobileKeysSeosProvider</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSessionParameters.html">MobileKeysSessionParameters</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSymmetricKeyPair.html">MobileKeysSymmetricKeyPair</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSelectionResult.html">MobileKeysSelectionResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysKeyNumber.html">MobileKeysKeyNumber</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysHashAlgorithm.html">MobileKeysHashAlgorithm</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysSelectionType.html">MobileKeysSelectionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysSeosSessionType.html">MobileKeysSeosSessionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysEncryptionAlgorithm.html">MobileKeysEncryptionAlgorithm</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SeosStatusWord.html">SeosStatusWord</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Seos Access API - sample code.html">Seos Access API - sample code</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="credential-for-test.html">Credential for test</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="read--write-tags-on-adf.html">Read &amp; write tags on ADF</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="read-adf-metadata.html">Read ADF metadata</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="master-authentication-keyset.html">Master authentication keyset</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="remote-session.html">Remote session</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="ake-session-setup.html">AKE Session Setup</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Advanced use cases.html">Advanced use cases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysMotionRecognizer.html">MobileKeysMotionRecognizer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MobileKeysMotionRecognizerDelegate.html">MobileKeysMotionRecognizerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MobileKeysManagerExtendedDelegate.html">MobileKeysManagerExtendedDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Advanced use cases - sample code.html">Advanced use cases - sample code</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="custom-opening-method.html">Custom opening method</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Constants.html">Other Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other Constants.html#/c:@MobileKeysOptionBeaconUUID">MobileKeysOptionBeaconUUID</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Enums.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysSessionClientIdentifier.html">MobileKeysSessionClientIdentifier</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='getting-started' class='heading'>Getting started</h1>
<h2 id='introductory-notes' class='heading'>Introductory notes</h2>

<p>Due to how the Mobile SDK is designed it does not support creating categories or inheriting from it&rsquo;s classes.</p>

<p>To initialize and configure the SDK use</p>

<ul>
<li><code>-[MobileKeysManager initWithDelegate:options]</code></li>
<li><code>-[MobileKeysManager setSupportedOpeningTypes]</code></li>
</ul>

<p>There are four Methods in the SDK to handle Seos TSM integration:</p>

<ul>
<li><code>-[MobileKeysManager isEndpointSetup]</code></li>
<li><code>-[MobileKeysManager setupEndpoint]</code></li>
<li><code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)updateEndpoint">-[MobileKeysManager updateEndpoint]</a></code></li>
<li><code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)startup">-[MobileKeysManager startup]</a></code></li>
</ul>

<p>In addition to these methods, there are Methods to turn BLE on/off and check the state of BLE</p>

<ul>
<li><code>-[MobileKeysManager startReaderScanInMode:supportedOpeningTypes:error]</code></li>
<li><code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)stopReaderScan">-[MobileKeysManager stopReaderScan]</a></code></li>
<li><code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)isScanning">-[MobileKeysManager isScanning]</a></code></li>
</ul>

<p>The Methods to communicate with the secure Seos storage are</p>

<ul>
<li><code>-[MobileKeysManager getEndpointInfo]</code></li>
<li><code>-[MobileKeysManager listMobileKeys]</code></li>
<li><code>-[MobileKeysManager lastAuthenticationInfo]</code></li>
</ul>

<p>Methods to query the SDK for general information</p>

<ul>
<li><code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)healthCheck">-[MobileKeysManager healthCheck]</a></code></li>
<li><code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)deviceHasBluetoothTurnedOn">-[MobileKeysManager deviceHasBluetoothTurnedOn]</a></code></li>
<li><code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)deviceSupportsBluetoothLowEnergy">-[MobileKeysManager deviceSupportsBluetoothLowEnergy]</a></code></li>
<li><code>-[MobileKeysManager getApiVersion]</code></li>
</ul>

<p>Methods to handle Readers</p>

<ul>
<li><code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)listReaders">-[MobileKeysManager listReaders]</a></code></li>
<li><code>-[MobileKeysManager getClosestReaderWithinRangeOfOpeningType]</code></li>
</ul>

<p>Methods to access data on specific Mobile Keys</p>

<ul>
<li><code>-[MobileKeysManager generateOTPForKey:error]</code></li>
<li><code>-[MobileKeysManager dataForKeyOid:tag:error]</code></li>
<li><code>-[MobileKeysManager putData:keyOid:tag:error]</code></li>
<li><code>-[MobileKeysManager activateMobileKey:error]</code></li>
<li><code>-[MobileKeysManager deactivateMobileKey:error]</code></li>
</ul>

<p>Methods to communicate directly with Seos</p>

<ul>
<li><code>-[MobileKeysManager openMobileKeysSeosSessionWithType:error]</code></li>
</ul>
<h2 id='step-1-create-a-new-instance-of-the-mobile-keys-sdk' class='heading'>Step 1: Create a new instance of the Mobile Keys SDK</h2>

<p>The <code>-[MobileKeysManager initWithDelegate:options]</code> init method requires two parameters;</p>

<ul>
<li>delegate: A delegate implementing the <code><a href="Protocols/MobileKeysManagerDelegate.html">MobileKeysManagerDelegate</a></code> protocol</li>
<li>options: A dictionary with the following content

<ul>
<li><code><a href="Mobile Keys.html#/c:@MobileKeysOptionApplicationId">MobileKeysOptionApplicationId</a></code>  a string provided by ASSA ABLOY that uniquely identifies the application</li>
<li><code><a href="Mobile Keys.html#/c:@MobileKeysOptionVersion">MobileKeysOptionVersion</a></code> a string describing the application name and version
will try to connect to. This will be provided by ASSA ABLOY</li>
<li><code><a href="Other Constants.html#/c:@MobileKeysOptionBeaconUUID">MobileKeysOptionBeaconUUID</a></code> A String specifying an iBeacon UUID to monitor when scanning is started in mode
<q>MobileKeysScanModeOptimizePerformance</q>. By default, the iBeacon id monitored is <q>00009999-0000-1000-8000-00177a000002</q>,
but for integrators that deploy own iBeacons, this can now be configured.</li>
</ul></li>
</ul>

<p>The first time the Mobile Keys SDK is used, it will</p>

<ul>
<li>Generate secure keys and store these in the Application keychain</li>
<li>Create and initialize a secure storage for Seos Keys</li>
</ul>

<p>On subsequent runs, the SDK will take care of</p>

<ul>
<li>Internal SDK upgrades</li>
</ul>
<h2 id='step-2-check-to-see-if-the-key-storage-has-been-setup-correctly' class='heading'>Step 2: Check to see if the Key Storage has been setup correctly</h2>

<p>Before the SDK can be used to communicate with Readers, the secure storage needs to be initialized and personalized.
Call the <code>-[MobileKeysManager isEndpointSetup]</code> method of the Mobile Keys SDK.</p>

<p>If the result is YES, everything is good to go, and you can call the <code>-[MobileKeysManager startReaderScanInMode:supportedOpeningTypes:error]</code> method</p>

<p>If the result is NO, you need to call the <code>-[MobileKeysManager setupEndpoint]</code> method, passing an
Invitation Code.</p>
<h2 id='step-3a-setting-up-the-endpoint-if-endpoint-has-not-yet-been-set-up' class='heading'>Step 3a: Setting up the endpoint (if endpoint has not yet been set up)</h2>

<p>This is expected on a completely new installation. The Seos data storage needs to initialized and configured, and
unique encryption keys have to be negotiated and established with the Seos TSM Server.
If the <code>-[MobileKeysManager isEndpointSetup]</code> returns NO, the SDK has not yet personalized the internal Seos
entity. The SDK will take care of Seos personalization when you call <code>-[MobileKeysManager setupEndpoint]</code></p>

<p>The SDK will then</p>

<ul>
<li>initialize the Seos instance (if i&rsquo;t not already initialized)</li>
<li>Connect to the Mobile Keys Seos TSM and download and install the unique keys for this particular Endpoint</li>
<li>Send a callback to the delegate, either to <code><a href="Protocols/MobileKeysManagerDelegate.html#/c:objc(pl)MobileKeysManagerDelegate(im)mobileKeysDidSetupEndpoint">-[MobileKeysManagerDelegate mobileKeysDidSetupEndpoint]</a></code> on success, or
<code>-[MobileKeysManagerDelegate mobileKeysDidFailToSetupEndpoint]</code> with and error code on a failure.</li>
</ul>

<p>What to do on a failure?</p>

<ul>
<li>If the SDK returns with an error that ends with <q>RetryError</q> (e.g. MobileKeysDeviceSetupFailedRetryError) the
application should (if possible) retry the same Invitation code again. The Mobile Keys SDK and Server should then be
able to pick up where it left off, and endpoint Setup should complete.</li>
</ul>
<h2 id='step-3b-using-an-endpoint-that-has-already-been-setup' class='heading'>Step 3b: Using an endpoint that has already been setup</h2>

<p>If the <code>-[MobileKeysManager isEndpointSetup]</code> returns YES, the endpoint has been setup, and is ready to use.
It is recommended to call the <code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)startup">-[MobileKeysManager startup]</a></code> method before using the SDK, this will
connect to the Mobile Keys Seos TSM to report the current application version, and will send a callback to the delegate
when finished.</p>
<h1 id='sdk-use-cases' class='heading'>SDK Use Cases</h1>

<p>This section describes the basic use cases for working with the Mobile Keys SDK.</p>
<h2 id='updating-key-info-from-the-mobile-keys-seos-tsm-server' class='heading'>Updating key info from the Mobile Keys Seos TSM Server</h2>

<p>Call the <code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)updateEndpoint">-[MobileKeysManager updateEndpoint]</a></code> method. The SDK will then connect to the Mobile Keys Seos TSM,
download updates for the current endpoint, and will then send a callback to the delegate when done.
This means that new keys, revocation of keys, etc. will be delivered to the phone from the Seos TSM. This
requires Internet connectivity.</p>

<p>Examples on when an update should be performed:</p>

<ul>
<li>On every startup, after <code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)startup">-[MobileKeysManager startup]</a></code></li>
<li>When your application receives a push message indicating that key changes have been done</li>
<li>When the Application user performs a manual update</li>
</ul>

<p>After updating, the caller will receive a callback, either <code><a href="Protocols/MobileKeysManagerDelegate.html#/c:objc(pl)MobileKeysManagerDelegate(im)mobileKeysDidUpdateEndpoint">-[MobileKeysManagerDelegate mobileKeysDidUpdateEndpoint]</a></code> on success, or
<code>-[MobileKeysManagerDelegate mobileKeysDidFailToUpdateEndpoint]</code> containing the error information if the update failed. The error case can occur
if there is a problem communicating with the secure storage, or if an other asynchronous method is currently running. When the method has
completed synchronizing with the Seos TSM, a call to the callback delegate will be made when the operation completes.</p>

<p>Updates can also uninstall the current endpoint, in that case <code><a href="Protocols/MobileKeysManagerDelegate.html#/c:objc(pl)MobileKeysManagerDelegate(im)mobileKeysDidTerminateEndpoint">-[MobileKeysManagerDelegate mobileKeysDidTerminateEndpoint]</a></code> instead of
<code>-[MobileKeysManagerDelegate mobileKeysDidFailToUpdateEndpoint]</code> is called on the delegate.</p>
<h2 id='listing-keys-on-the-secure-storage' class='heading'>Listing keys on the Secure Storage</h2>

<p>Use the <code>-[MobileKeysManager listMobileKeys]</code> method to get an NSArray of
<code>-[MobileKeysKey]</code> class Objects. The information
returned will either be fetched immediately from the Seos Secure Storage, or from the internal SDK cache if the
Seos Secure Storage is currently busy.</p>

<p>Additionally, you can fetch information about the last authenticated key with the <code>-[MobileKeysManager lastAuthenticationInfo]</code> method.
It will return an <code>-[MobileKeysLastAuthenticationInfo]</code> object containing information about whether or not the reader has written information
to the key: <code>-[MobileKeysLastAuthenticationInfo authenticationCounter]</code>, how many times the key has authenticated: <code>-[MobileKeysLastAuthenticationInfo isModified]</code>
as well as the key that was authenticated: <code>-[MobileKeysLastAuthenticationInfo lastAuthenticatedMobileKey]</code>.</p>
<h2 id='turning-ble-communication-on-off' class='heading'>Turning BLE communication on/off</h2>

<p>Bluetooth LE communication can be turned on or off. Use the <code>-[MobileKeysManager startReaderScanInMode:supportedOpeningTypes:lockServiceCodes:error]</code>
and <code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)stopReaderScan">-[MobileKeysManager stopReaderScan]</a></code> respectively to do this.</p>

<p>Examples on when to use these methods:</p>

<ul>
<li>If the Mobile Keys SDK reports that there are no keys on this endpoint, it makes sense to turn off BLE Scanning
to preserve battery</li>
<li>Make sure that the endpoint has been setup before turning on BLE Scanning</li>
</ul>

<p>Bluetooth scanning can be configured to run in two Scanning Modes.</p>

<ul>
<li><code>MobileKeysScanModeOptimizePerformance</code></li>
<li><code>MobileKeysScanModeOptimizePowerConsumption</code></li>
</ul>

<p>If your application is only scanning in the foreground, we recommend that you use <code>MobileKeysScanModeOptimizePowerConsumption</code>. <code>MobileKeysScanModeOptimizePerformance</code>
will consume more power, but will work better if your application is running in the background.</p>

<p>Additionally, if you want to use background modes, see the chapter on Configuring the application to run in the background</p>

<p>The parameter <code>supportedOpeningTypes</code> is an <code>NSArray</code> of <code><a href="Enums/MobileKeysOpeningType.html">MobileKeysOpeningType</a></code> values. Since 1.1.6,
this is enforced by the SDK. This means that you MUST add the opening types that you want to support,
for example <code>MobileKeysOpeningTypeMotion</code> to support Twist and Go opening Type.</p>
<h2 id='implementing-custom-mechanics-for-opening-readers' class='heading'>Implementing custom mechanics for opening readers</h2>

<p>Besides the built-in functionality to open readers. It is possible to implement custom functionality of opening readers.
The SDK supports two types of use cases:</p>

<p>The first use case is external trigger or user action: for example an event being sent from one of the devices sensors or a through the press of a button in the
applications interface. To list all the readers currently in the devices vicinity use the <code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)listReaders">-[MobileKeysManager listReaders]</a></code> method. To get the closest
reader within the range of a specific <code>-[MobileKeysReader MobileKeysOpeningType]</code> use the <code>-[MobileKeysManager getClosestReaderWithinRangeOfOpeningType]</code>
method.</p>

<p>You will then be able to interact with that reader through the <code>-[MobileKeysManager connectToReaderWithOpeningType:openingType:error]</code> method.
The SDK exposes the patented Twist and Go motion pattern through the <code><a href="Protocols/MobileKeysManagerDelegate.html#/c:objc(pl)MobileKeysManagerDelegate(im)mobileKeysUserDidUnlockGesture">-[MobileKeysManagerDelegate mobileKeysUserDidUnlockGesture]</a></code> delegate method,
which can be used in this manner.</p>

<p>The second use case is automatically based upon reader advertisements: callbacks will be sent to the <code>-[MobileKeysManagerDelegate mobileKeysShouldInteractWithScannedReader]</code> method whenever
the SDK receives a new advertisement from a reader. The properties <code><a href="Classes/MobileKeysReader.html#/c:objc(cs)MobileKeysReader(im)meanRssi">-[MobileKeysReader meanRssi]</a></code> and <code><a href="Classes/MobileKeysReader.html#/c:objc(cs)MobileKeysReader(im)rssiList">-[MobileKeysReader rssiList]</a></code> can be used to estimate
the distance of the reader relative to the device. Please note the RSSI value is only a measurement of signal strength and can not be used to determine the exact
distance between the device and the reader. Return a boolean indicating the decision to try to interact with the reader or not.</p>
<h2 id='getting-information-about-the-endpoint' class='heading'>Getting information about the Endpoint</h2>

<p>Use the <code>-[MobileKeysManager endpointInfo]</code> method to get information about the current endpoint status. The information
returned will either be fetched immediately from the Seos Secure Storage, or from the internal SDK cache if the
Seos Secure Storage is currently busy.</p>
<h2 id='querying-the-sdk-for-warnings' class='heading'>Querying the SDK for warnings</h2>

<p>The Mobile Keys SDK has a built in method to detect if BLE is supported on the device, or if Bluetooth has been turned off.</p>

<p>Use the <code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)healthCheck">-[MobileKeysManager healthCheck]</a></code> method to get an <code>NSArray</code> of <code>-[MobileKeysInfo]</code> class Objects.</p>

<p>It is also possible to use the <code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)deviceHasBluetoothTurnedOn">-[MobileKeysManager deviceHasBluetoothTurnedOn]</a></code> and <code><a href="Classes/MobileKeysManager.html#/c:objc(cs)MobileKeysManager(im)deviceSupportsBluetoothLowEnergy">-[MobileKeysManager deviceSupportsBluetoothLowEnergy]</a></code>
methods to check if the Device supports BLE and has bluetooth turned on.</p>
<h2 id='unregistering-an-endpoint' class='heading'>Unregistering an endpoint</h2>

<p>The SDK does not provide a direct way of unregistering/opting out from the Mobile Keys Service. Instead, this
is managed from the TSM side. Key revocations and uninstall commands are downloaded to the phone when calling the
<code>-[MobileKeysManager endpointUpdate]</code> method. If this results in the endpoint being uninstalled, the delegate
method <code><a href="Protocols/MobileKeysManagerDelegate.html#/c:objc(pl)MobileKeysManagerDelegate(im)mobileKeysDidTerminateEndpoint">-[MobileKeysManagerDelegate mobileKeysDidTerminateEndpoint]</a></code>.</p>

<p>If <code><a href="Protocols/MobileKeysManagerDelegate.html#/c:objc(pl)MobileKeysManagerDelegate(im)mobileKeysDidTerminateEndpoint">-[MobileKeysManagerDelegate mobileKeysDidTerminateEndpoint]</a></code> has been called, the endpoint is no longer
personalized, and the Seos Environment is ready for setup again.</p>
<h2 id='configuring-the-application-to-run-in-the-background' class='heading'>Configuring the application to run in the background</h2>

<p>Behavior has changed between iOS 10 and iOS 11. To ensure compatibility with both applications that need to run in the
background and application that only need to run in the foreground, configuration of the background modes has been
removed from the SDK, and must be managed by the application.</p>

<p>For applications that only need to run in the foreground,
the method [MobileKeysManager startReaderScanInMode:supportedOpeningTypes:lockServiceCodes:error:] with scanMode
MobileKeysScanModeOptimizeBatteryConsumption should be used. In those cases, it is not required to enable background
modes according to the description below.</p>

<p>For applications that need to run in the background,
the method [MobileKeysManager startReaderScanInMode:supportedOpeningTypes:lockServiceCodes:error:] with scanMode
MobileKeysScanModeOptimizePerformance should be used. In those cases, it is required to enable background
modes according to the description below.</p>
<h2 id='enabling-background-running' class='heading'>Enabling background running</h2>

<p>For any application that needs to be run in the background, steps 2, 3 and 4 below need to be
performed by the application. Step 3 can be performed by the application at any time (e.g. when the application is put
in the background, or when it starts) , and step 4 needs to be performed by the application before calling the
[MobileKeysManager startReaderScanInMode: MobileKeysScanModeOptimizePerformance supportedOpeningTypes:lockServiceCodes:error:] method.</p>

<p>The application needs to instantiate a CLLocationManager to perform steps 2,3 and 4.</p>

<ol>
<li><p>Background mode: Location updates
For iOS 11, the project setting background mode <q>Location updates</q> is required. iOS will suspend operations after
approximately 6-8 seconds otherwise.</p></li>
<li><p>CLLocationManager::allowsBackgroundLocationUpdates must be set to YES.
It is possible to disable the background mode by setting this to NO, e.g. if the apps wants to allow the user to disable
the background mode</p></li>
<li><p>CLLocationManager::requestAlwaysAuthorization
This will present the user with information about the background modes. The appropriate information needs to be added to
NSLocationWhenInUseUsageDescription, NSLocationAlwaysAndWhenInUseUsageDescription, NSLocationAlwaysUsageDescription and
possibly even to NSLocationUsageDescription in the info.plist.</p></li>
<li><p>CLLocationManager::startUpdatingLocation tells iOS to start giving us ranginginformation
For iOS 11, this is required if the application needs persistent ranging.</p></li>
</ol>
<h2 id='killing-the-app' class='heading'>Killing the app</h2>

<p>For the “Killed state”, ranging stops working after approximately 15 to 30 minutes. However, if the user force quits
the app by swiping it away, it could be argued that he or she doesn’t want the app running.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>© 2017 ASSA ABLOY Mobile Services. All rights reserved.</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.8.4</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
