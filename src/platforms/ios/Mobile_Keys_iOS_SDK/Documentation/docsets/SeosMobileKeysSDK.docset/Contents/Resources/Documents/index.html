<!DOCTYPE html>
<html lang="en">
  <head>
    <title>SeosMobileKeysSDK  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="SeosMobileKeysSDK  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          SeosMobileKeysSDK Docs
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">SeosMobileKeysSDK Reference</a>
      <img class="carat" src="img/carat.png" />
      SeosMobileKeysSDK  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Getting started.html">Getting started</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="getting-started-with-the-sdk.html">Getting started with the SDK</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="installation-without-cocoapods.html">Installation without CocoaPods</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="logging.html">Logging</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Mobile Keys.html">Mobile Keys</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysManager.html">MobileKeysManager</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MobileKeysManagerDelegate.html">MobileKeysManagerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysEndpointInfo.html">MobileKeysEndpointInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysKey.html">MobileKeysKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysLastAuthenticationInfo.html">MobileKeysLastAuthenticationInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysErrorDomain">MobileKeysErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysHttpErrorDomain">MobileKeysHttpErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysOptionApplicationId">MobileKeysOptionApplicationId</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysOptionVersion">MobileKeysOptionVersion</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/EnvironmentType.html">EnvironmentType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysInfoType.html">MobileKeysInfoType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysErrorCode.html">MobileKeysErrorCode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@MobileKeysPreconditionFailedException">MobileKeysPreconditionFailedException</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Mobile Keys.html#/c:@F@MobileKeysPreconditionCheckTriggered">MobileKeysPreconditionCheckTriggered</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Bluetooth.html">Bluetooth</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysOpeningResult.html">MobileKeysOpeningResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysTimeoutConfiguration.html">MobileKeysTimeoutConfiguration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysOpeningStatusType.html">MobileKeysOpeningStatusType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysOpeningType.html">MobileKeysOpeningType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysReader.html">MobileKeysReader</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysScanMode.html">MobileKeysScanMode</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysReaderProtocolVersion.html">MobileKeysReaderProtocolVersion</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Seos Access API.html">Seos Access API</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSeosSession.html">MobileKeysSeosSession</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSeosTag.html">MobileKeysSeosTag</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysApduCommand.html">MobileKeysApduCommand</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MobileKeysApduConnectionProtocol.html">MobileKeysApduConnectionProtocol</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysApduResponse.html">MobileKeysApduResponse</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysAuthenticationKeySet.html">MobileKeysAuthenticationKeySet</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysMasterAuthenticationKeySet.html">MobileKeysMasterAuthenticationKeySet</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysGetDataApduCommand.html">MobileKeysGetDataApduCommand</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysPrivacyKeySet.html">MobileKeysPrivacyKeySet</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysPutDataApduCommand.html">MobileKeysPutDataApduCommand</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSeosProvider.html">MobileKeysSeosProvider</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSessionParameters.html">MobileKeysSessionParameters</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSymmetricKeyPair.html">MobileKeysSymmetricKeyPair</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysSelectionResult.html">MobileKeysSelectionResult</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysKeyNumber.html">MobileKeysKeyNumber</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysHashAlgorithm.html">MobileKeysHashAlgorithm</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysSelectionType.html">MobileKeysSelectionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysSeosSessionType.html">MobileKeysSeosSessionType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysEncryptionAlgorithm.html">MobileKeysEncryptionAlgorithm</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SeosStatusWord.html">SeosStatusWord</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Seos Access API - sample code.html">Seos Access API - sample code</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="credential-for-test.html">Credential for test</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="read--write-tags-on-adf.html">Read &amp; write tags on ADF</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="read-adf-metadata.html">Read ADF metadata</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="master-authentication-keyset.html">Master authentication keyset</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="remote-session.html">Remote session</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="ake-session-setup.html">AKE Session Setup</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Advanced use cases.html">Advanced use cases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/MobileKeysMotionRecognizer.html">MobileKeysMotionRecognizer</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MobileKeysMotionRecognizerDelegate.html">MobileKeysMotionRecognizerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/MobileKeysManagerExtendedDelegate.html">MobileKeysManagerExtendedDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Advanced use cases - sample code.html">Advanced use cases - sample code</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="custom-opening-method.html">Custom opening method</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Constants.html">Other Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Other Constants.html#/c:@MobileKeysOptionBeaconUUID">MobileKeysOptionBeaconUUID</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Other Enums.html">Other Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MobileKeysSessionClientIdentifier.html">MobileKeysSessionClientIdentifier</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content">
            
            <h1 id='introduction' class='heading'>Introduction</h1>

<p>This documents the ASSA ABLOY Mobile Keys iOS SDK. The SDK itself consists of a dynamic framework that can be linked
into IOS Applications.</p>

<p>The SDK takes care of the following main tasks:</p>

<ul>
<li>Bluetooth communication with compatible BLE locks implementing the Seos Lock Profile</li>
<li>Communication with the Seos TSM Server</li>
<li>Secure storage of Digital Keys in an encrypted Soft Seos file</li>
<li>Communication with an optional Readback server</li>
</ul>

<p>In addition to this, the following optional functionality is built into the SDK</p>

<ul>
<li>Motion Detection of the device (Rotate device to trigger a BLE connection to the closest supported reader)</li>
<li>Location Monitoring using iBeacons (improves BLE responsiveness)</li>
</ul>

<p><img src="img/High_Level_Architecture.jpg" alt="High Level System Overview"></p>
<h1 id='introductory-installation-notes' class='heading'>Introductory installation notes</h1>

<p>There are two flavors of the SDK, Release and Debug. Both are dynamic Cocoa Touch Frameworks.</p>

<p>The Release flavour contained in the Release directory of the SDK package is protected and encrypted (from 1.3.0) and
is intended to be used when you publish your application to the App Store or the beta distribution programs such as Apple TestFlight.</p>

<p>The Debug flavor contained in the Debug directory is meant to be used during development. It will only work with developer provisioning
and will throw an exception if used within an app downloaded from the app store.</p>

<p>Both SDK binaries are universal frameworks, this means that they contain both the iphonesimulator
and the iphoneos architectures. Please make sure to use the build setting “Build Active Architecture only (ONLY_ACTIVE_ARCH) = YES” when publishing,
as Apples servers will automatically reject uploaded bundles that contain simulator slices.</p>

<p>If you are using CocoaPods in your application project you can disregard the Thirdparty directory of the SDK package.
Please refer to the <q>Installation using CocoaPods</q> guide, after that continue to <q>General installation notes</q>.</p>

<p>If you are not using CocoaPods, please read the <q>Installation without CocoaPods</q> guide
and after that continue to <q>General installation notes</q>.</p>
<h1 id='installation-using-cocoapods' class='heading'>Installation using CocoaPods</h1>

<p>For a reference to using CocoaPods: <a href="https://guides.cocoapods.org/using/">https://guides.cocoapods.org/using/</a>.
Together with the Mobile Keys SDK you will find two CocoaPods podspec files: <code>SeosMobileKeysSDK-.podspec</code>. These files
are in the Debug and Release folders respectively.
Simply use these file as a dependency in your app projects podfile:</p>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'SeosMobileKeysSDK'</span><span class="p">,</span> <span class="ss">:path</span> <span class="o">=&gt;</span> <span class="s1">'&lt;Mobile Keys SDK Package&gt;/SeosMobileKeysSDK-[flavor].podspec'</span>
</code></pre>

<p>If you want to use different binaries for e.g. Debug and Release, you can look at the example application Podfile for
an example on how to set this up. In short, something along these lines should do it:</p>
<pre class="highlight ruby"><code><span class="n">project</span> <span class="s1">'SeosExampleApplication'</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">'Debug'</span> <span class="o">=&gt;</span> <span class="ss">:debug</span><span class="p">,</span>
    <span class="s1">'Release'</span> <span class="o">=&gt;</span> <span class="ss">:release</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">applibs</span>
    <span class="n">pod</span> <span class="s1">'SeosMobileKeysSDK-Debug'</span><span class="p">,</span> <span class="ss">:configuration</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'Debug'</span><span class="p">],</span> <span class="ss">:path</span>  <span class="o">=&gt;</span> <span class="s1">'Mobile_Keys_IOS_SDK/Debug/SeosMobileKeysSDK-Debug.podspec'</span>
    <span class="n">pod</span> <span class="s1">'SeosMobileKeysSDK-Release'</span><span class="p">,</span> <span class="ss">:configuration</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">'Release'</span><span class="p">],</span> <span class="ss">:path</span>  <span class="o">=&gt;</span> <span class="s1">'Mobile_Keys_IOS_SDK/Release/SeosMobileKeysSDK-Release.podspec'</span>
<span class="k">end</span>
</code></pre>

<p>Keep in mind that the podspec contains relative path references to the SDK artifacts and if you move them you will need to update the podspec.</p>
<h2 id='use_frameworks' class='heading'>use_frameworks!</h2>

<p>Currently, the Mobile SDK relies on it&rsquo;s dependencies being dynamic frameworks. Unfortunately this means that the integrating application
also need to use this option with CocoaPods for the SeosMobileKeysSDK to work. If this requirement is incompatible with the integrating application,
for instance the integrating application depends on a pod that must be a static library you can work around this limitation.</p>

<ul>
<li>Option 1: If it&rsquo;s the case that the integrating application depends on a pod that must be compiled statically, it can be an option to take keep this
dependency outside of CocoaPods by taking the built product and drag it into Xcode.</li>
<li>Option 2: Use the Mobile SDK outside of Cocoapods. Refer to the &lsquo;Installation without CocoaPods&rsquo; section for detailed instructions.</li>
</ul>
<h1 id='general-installation-notes' class='heading'>General installation notes</h1>
<h2 id='background-modes' class='heading'>Background modes</h2>

<p>The application needs to specify the background mode <q>bluetooth-central</q>, or BLE will not work when the application
is in the background.</p>

<p>Starting with iOS 10.0, An iOS app which accesses the Bluetooth interface, must
statically declare the intent to do so. Include the NSBluetoothPeripheralUsageDescription key in your app’s
Info.plist file and provide a purpose string for this key. If your app attempts to access the Bluetooth interface
without a corresponding purpose string, your app exits</p>

<p>For running the application in the background some additional steps are also required.
If the application tries to start BLE scanning using the mode MobileKeysScanModeOptimizePerformance,
the application now needs to request authorization from the OS and enable background location updates. If background
operation is not required, use the MobileKeysScanModeOptimizePowerConsumption scan mode instead.</p>

<p>When the scan mode <q>MobileKeysScanModeOptimizePerformance</q> is used, the SDK will call CLLocationManager::startUpdatingLocation.
iOS will prevent this (fatal error according to the documentation) unless the application first sets the</p>

<p>CLLocationManager::allowsBackgroundLocationUpdates property to YES and</p>

<p>calls the</p>

<p>CLLocationManager::requestAlwaysAuthorization</p>

<p>function that will query the user to authorize location updates preferably in the background.</p>

<p>In addition to this code change, the application also needs to add the appropriate NSLocationWhenInUseUsageDescription,
NSLocationAlwaysAndWhenInUseUsageDescription, NSLocationAlwaysUsageDescription and NSLocationUsageDescription to info.plist</p>
<h1 id='phone-resources-used' class='heading'>Phone Resources used</h1>

<p>The following resources are used by the API. These can change at any time, and should not be used by the application.
This list is provided to help your application avoid conflicts or clashes.
In future releases, the SDK might contain methods to initialize and destroy these resources by the application.</p>
<h2 id='nsuserdefaults-parameters-all-internal-do-not-use-or-rely-on-these' class='heading'>NSUserDefaults Parameters (All internal, do not use or rely on these)</h2>

<ul>
<li>aamkMobileApiCurrentVersion - Used to store the current version of the API</li>
<li>aamkMobileApiPropertiesChecksum - Internal parameter</li>
<li>aaSeosMobileKeysFirstBootKeyValue - Internal Parameter</li>
<li>aamkMobileApiCurrentPushID - Internal Parameter, keeps the last known Push Id reported to the API</li>
<li>aamkMobileApiLastServerSyncDate - Internal Parameter, keeps the last successful server communication date</li>
<li>EndOfSeosFileSystem - Internal Parameter</li>
</ul>
<h2 id='keychain-items-all-internal-do-not-use-or-rely-on-these' class='heading'>KeyChain Items (All internal, do not use or rely on these)</h2>

<p>Part of the encryption key used for encrypting Seos data is stored in the KeyChain.
For the encryption keys, the following identifiers are used:</p>

<ul>
<li>kSecClass: kSecClassGenericPassword</li>
<li>kSecAttrGeneric</li>
<li>kSecAttrService</li>
<li>kSecAttrAccount</li>
</ul>
<h2 id='files-all-internal-do-not-use-or-rely-on-these' class='heading'>Files (All internal, do not use or rely on these)</h2>

<p>The Encrypted Seos File Structure is called <q>seosdata</q> and is stored in the NSApplicationSupportDirectory.</p>
<pre class="highlight objective_c"><code><span class="p">[[</span><span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSApplicationSupportDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">)</span> <span class="nf">lastObject</span><span class="p">]</span> <span class="nf">stringByAppendingPathComponent</span><span class="p">:</span><span class="s">@"seosdata"</span><span class="p">];</span>
</code></pre>

<p>In addition to this file, there is one companion file called <q>seosdata.bak</q>.</p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>© 2017 ASSA ABLOY Mobile Services. All rights reserved.</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.8.4</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
